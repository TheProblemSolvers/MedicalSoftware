<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Software</title>
    <script src="../scripts.js"></script>
    <link rel="stylesheet" type="text/css" href="../universal-style.css">
    <link rel="stylesheet" type="text/css" href="../nav-content-footer.css">
    <link rel="stylesheet" type="text/css" href="../calendar-style.css">
</head>

<body id="filler">

    <div id="navDiv" class="topnav">
        <a href="../index.html">Logout</a>
        <a href="patient_lander.html">Home</a>
        <a href="patient_checkin.html">Check-In</a>
        <a href="patient_calendar.html">Calender</a>
        <a href="patient_app_scheduler.html">Scheduler</a>
        <a href="patient_profile.html">Your Profile</a>
        <a href="patient_accountSync.html">Account Syncing</a>
        <a href="patient_settings.html">Settings</a>
    </div>

    <section class="content">

        <h1 id="patientCalendarHeader">Appointment Scheduling</h1>

        <div id="appointment">

            <?php 
            require("../scripts.php");
            if(getSqlLinkedAccount($_COOKIE['userId']) == false){
                echo "<p class='errorMessage'>No provider account linked. <br>Please link a providers account to continue.</p>";
            }
        ?>

            <form method="POST" action="<?php echo htmlspecialchars($_SERVER['PHP_SELF']);?>">

                <label><em>Is This an Emergency?</em></label><br><br>
                <input type="button" onclick="emergencyButton('Yes');" value="Yes">
                <input type="button" onclick="emergencyButton('No');" value="No">
                <p id="emergency" style="color: red;"></p>

                <label for="Appointment Type"><em>Appointment Type:</em></label><br><br>

                <select name="apptType" list="Appointment Types" value="Appointment Type" id="appType">
                    <option value="Well Visit">Well Visit</option>
                    <option value="Office Visit">Office Visit</option>
                    <option value="Physical">Physical</option>
                    <option value="School/Sports Physical">School/Sports Physical</option>
                    <option value="Screening Diagnostic Labs">Screening Diagnostic Labs</option>
                    <option value="Healthcare Visit">Healthcare Visit</option>
                </select><br><br>

                <!-- Input for selecting a time -->
                <label for="timeInput">Appointment Time</label><br><br>
                <input type="time" name="timeInput" id="timeInput" min="07:00:00" max="17:30:00" step="1800" required><br><br>

                <!-- Input for selecting a date -->
                <label for="calInput">Appointment Date</label><br><br>
                <input type="date" name="calInput" id="calInput" required><br><br>

                <!-- Input for adding text to cell -->
                <label for="addInfo">Additional Information</label><br><br>
                <input type="text" name="addInfo" id="addInfo"><br><br>

                <!-- Function call for date input -->
                <input type="submit" value="Schedule Appointment">

            </form>

            <?php
            if($_SERVER['REQUEST_METHOD'] == "POST"){
                echo "<br>" . storeApptData($_COOKIE['userId'], $_POST['apptType'], $_POST['addInfo'], 
                    $_POST['calInput'], $_POST['timeInput']);
                //header("Refresh:0; url=#");
            }
        ?>

                <!-- --------------------------data transfer testing---------------------------------- -->

                <p id="testing"></p>

                <?php $appointmentsArray = getAllAppts($_COOKIE['userId']); ?>

                <script type="text/javascript">
                    var appointmentsArray = <?php echo json_encode($appointmentsArray); ?>;
                </script>

                <!-- --------------------------data transfer testing---------------------------------- -->
                <br>

                <style>
                    #calendars {
                        width: 65%;
                        margin-left: 30%;
                    }
                </style>
        </div>

        <div>

            <body id="" onload="printCalendar(currentMonth, currentYear, appointmentArray)"></body>
        </div>

    </section>

    <button id="navBtn" onclick="shiftNav()">â˜°</button>


    <div class="footer">
        <p>Contact Us at sigmund Froyyd@gmail.com </p>
    </div>

</body>

</html>